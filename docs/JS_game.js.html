<!DOCTYPE html>
<html lang="en">
<head>
    
    <meta charset="utf-8">
    <title>JS/game.js - Documentation</title>
    
    
    <script src="scripts/prettify/prettify.js"></script>
    <script src="scripts/prettify/lang-css.js"></script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc.css">
    <script src="scripts/nav.js" defer></script>
    
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
</head>
<body>

<input type="checkbox" id="nav-trigger" class="nav-trigger" />
<label for="nav-trigger" class="navicon-button x">
  <div class="navicon"></div>
</label>

<label for="nav-trigger" class="overlay"></label>

<nav >
    
    <input type="text" id="nav-search" placeholder="Search" />
    
    
    <h2><a href="index.html">Home</a></h2><h3>Classes</h3><ul><li><a href="BackgroundObject.html">BackgroundObject</a></li><li><a href="Bottles.html">Bottles</a><ul class='methods'><li data-type='method'><a href="Bottles.html#.animate#animate">animate</a></li></ul></li><li><a href="Character.html">Character</a><ul class='methods'><li data-type='method'><a href="Character.html#.animate#animate">animate</a></li></ul></li><li><a href="Chick.html">Chick</a><ul class='methods'><li data-type='method'><a href="Chick.html#.animate#animate">animate</a></li></ul></li><li><a href="Chicken.html">Chicken</a><ul class='methods'><li data-type='method'><a href="Chicken.html#.animate#animate">animate</a></li></ul></li><li><a href="Clouds.html">Clouds</a><ul class='methods'><li data-type='method'><a href="Clouds.html#.animate#animate">animate</a></li></ul></li><li><a href="Coins.html">Coins</a><ul class='methods'><li data-type='method'><a href="Coins.html#.animate#animate">animate</a></li></ul></li><li><a href="DrawableObject.html">DrawableObject</a><ul class='methods'><li data-type='method'><a href="DrawableObject.html#.AudioToArray#AudioToArray">AudioToArray</a></li><li data-type='method'><a href="DrawableObject.html#.draw#draw">draw</a></li><li data-type='method'><a href="DrawableObject.html#.drawFrame#drawFrame">drawFrame</a></li><li data-type='method'><a href="DrawableObject.html#.loadImage#loadImage">loadImage</a></li><li data-type='method'><a href="DrawableObject.html#.loadImages#loadImages">loadImages</a></li></ul></li><li><a href="Endboss.html">Endboss</a><ul class='methods'><li data-type='method'><a href="Endboss.html#.animate#animate">animate</a></li><li data-type='method'><a href="Endboss.html#.checkIfCharacterIsAtBoss#checkIfCharacterIsAtBoss">checkIfCharacterIsAtBoss</a></li><li data-type='method'><a href="Endboss.html#.checkIfDead#checkIfDead">checkIfDead</a></li></ul></li><li><a href="Keyboard.html">Keyboard</a></li><li><a href="Level.html">Level</a></li><li><a href="MoveableObject.html">MoveableObject</a><ul class='methods'><li data-type='method'><a href="MoveableObject.html#.applyGravity#applyGravity">applyGravity</a></li><li data-type='method'><a href="MoveableObject.html#.fallDown#fallDown">fallDown</a></li><li data-type='method'><a href="MoveableObject.html#.hit#hit">hit</a></li><li data-type='method'><a href="MoveableObject.html#.isAboveGround#isAboveGround">isAboveGround</a></li><li data-type='method'><a href="MoveableObject.html#.isColliding#isColliding">isColliding</a></li><li data-type='method'><a href="MoveableObject.html#.isDead#isDead">isDead</a></li><li data-type='method'><a href="MoveableObject.html#.isHurt#isHurt">isHurt</a></li><li data-type='method'><a href="MoveableObject.html#.isOnGround#isOnGround">isOnGround</a></li><li data-type='method'><a href="MoveableObject.html#.playAnimation#playAnimation">playAnimation</a></li><li data-type='method'><a href="MoveableObject.html#.playAudio#playAudio">playAudio</a></li></ul></li><li><a href="Overlay.html">Overlay</a></li><li><a href="StatusBar.html">StatusBar</a><ul class='methods'><li data-type='method'><a href="StatusBar.html#.resolveImageIndex#resolveImageIndex">resolveImageIndex</a></li><li data-type='method'><a href="StatusBar.html#.setPercentage#setPercentage">setPercentage</a></li></ul></li><li><a href="StatusBarCoins.html">StatusBarCoins</a><ul class='methods'><li data-type='method'><a href="StatusBarCoins.html#.resolveImageIndex#resolveImageIndex">resolveImageIndex</a></li><li data-type='method'><a href="StatusBarCoins.html#.setPercentage#setPercentage">setPercentage</a></li></ul></li><li><a href="StatusBarEndboss.html">StatusBarEndboss</a><ul class='methods'><li data-type='method'><a href="StatusBarEndboss.html#.resolveImageIndex#resolveImageIndex">resolveImageIndex</a></li><li data-type='method'><a href="StatusBarEndboss.html#.setPercentage#setPercentage">setPercentage</a></li></ul></li><li><a href="StatusBarFlasks.html">StatusBarFlasks</a><ul class='methods'><li data-type='method'><a href="StatusBarFlasks.html#.resolveImageIndex#resolveImageIndex">resolveImageIndex</a></li><li data-type='method'><a href="StatusBarFlasks.html#.setPercentage#setPercentage">setPercentage</a></li></ul></li><li><a href="ThrowableObject.html">ThrowableObject</a><ul class='methods'><li data-type='method'><a href="ThrowableObject.html#.animate#animate">animate</a></li><li data-type='method'><a href="ThrowableObject.html#.applyGravity#applyGravity">applyGravity</a></li><li data-type='method'><a href="ThrowableObject.html#.checkIfThrew#checkIfThrew">checkIfThrew</a></li><li data-type='method'><a href="ThrowableObject.html#.fallDown#fallDown">fallDown</a></li><li data-type='method'><a href="ThrowableObject.html#.hit#hit">hit</a></li><li data-type='method'><a href="ThrowableObject.html#.isAboveGround#isAboveGround">isAboveGround</a></li><li data-type='method'><a href="ThrowableObject.html#.isColliding#isColliding">isColliding</a></li><li data-type='method'><a href="ThrowableObject.html#.isDead#isDead">isDead</a></li><li data-type='method'><a href="ThrowableObject.html#.isHurt#isHurt">isHurt</a></li><li data-type='method'><a href="ThrowableObject.html#.isOnGround#isOnGround">isOnGround</a></li><li data-type='method'><a href="ThrowableObject.html#.playAnimation#playAnimation">playAnimation</a></li><li data-type='method'><a href="ThrowableObject.html#.playAudio#playAudio">playAudio</a></li><li data-type='method'><a href="ThrowableObject.html#.throw#throw">throw</a></li></ul></li><li><a href="World.html">World</a><ul class='methods'><li data-type='method'><a href="World.html#.addObjectsToMap#addObjectsToMap">addObjectsToMap</a></li><li data-type='method'><a href="World.html#.addOverlay#addOverlay">addOverlay</a></li><li data-type='method'><a href="World.html#.addToMap#addToMap">addToMap</a></li><li data-type='method'><a href="World.html#.bottleCollidingEnemy#bottleCollidingEnemy">bottleCollidingEnemy</a></li><li data-type='method'><a href="World.html#.checkCollisions#checkCollisions">checkCollisions</a></li><li data-type='method'><a href="World.html#.checkIfWinOrLose#checkIfWinOrLose">checkIfWinOrLose</a></li><li data-type='method'><a href="World.html#.checkThrowObjects#checkThrowObjects">checkThrowObjects</a></li><li data-type='method'><a href="World.html#.collectBottles#collectBottles">collectBottles</a></li><li data-type='method'><a href="World.html#.collectCoins#collectCoins">collectCoins</a></li><li data-type='method'><a href="World.html#.draw#draw">draw</a></li><li data-type='method'><a href="World.html#.flipImage#flipImage">flipImage</a></li><li data-type='method'><a href="World.html#.flipImageBack#flipImageBack">flipImageBack</a></li><li data-type='method'><a href="World.html#.hitByBottle#hitByBottle">hitByBottle</a></li><li data-type='method'><a href="World.html#.jumpAfterKill#jumpAfterKill">jumpAfterKill</a></li><li data-type='method'><a href="World.html#.killByBottle#killByBottle">killByBottle</a></li><li data-type='method'><a href="World.html#.killByJump#killByJump">killByJump</a></li><li data-type='method'><a href="World.html#.pauseAudio#pauseAudio">pauseAudio</a></li><li data-type='method'><a href="World.html#.playAudio#playAudio">playAudio</a></li><li data-type='method'><a href="World.html#.returnCharacterPosition#returnCharacterPosition">returnCharacterPosition</a></li><li data-type='method'><a href="World.html#.revealBossHealth#revealBossHealth">revealBossHealth</a></li><li data-type='method'><a href="World.html#.run#run">run</a></li><li data-type='method'><a href="World.html#.setWorld#setWorld">setWorld</a></li><li data-type='method'><a href="World.html#.stopGame#stopGame">stopGame</a></li></ul></li></ul><h3>Global</h3><ul><li><a href="global.html#fullScreen">fullScreen</a></li><li><a href="global.html#handleDisappearingObjects">handleDisappearingObjects</a></li><li><a href="global.html#handleMobileButtons">handleMobileButtons</a></li><li><a href="global.html#handleTurnDeviceWarning">handleTurnDeviceWarning</a></li><li><a href="global.html#hideObject">hideObject</a></li><li><a href="global.html#idle">idle</a></li><li><a href="global.html#init">init</a></li><li><a href="global.html#initLevel">initLevel</a></li><li><a href="global.html#mobileButtonsPressEvents">mobileButtonsPressEvents</a></li><li><a href="global.html#playBackgoundMusic">playBackgoundMusic</a></li><li><a href="global.html#reloadPage">reloadPage</a></li><li><a href="global.html#revealObject">revealObject</a></li><li><a href="global.html#toggleControls">toggleControls</a></li><li><a href="global.html#toggleMuteAudio">toggleMuteAudio</a></li></ul>
    
</nav>

<div id="main">
    
    <h1 class="page-title">JS/game.js</h1>
    

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>let canvas;
let world;
let keyboard = new Keyboard();
let isFullscreen = false;
let isMuted = false;
let background_music = new Audio('audio/background-music.mp3');
let soundEffects = [
    background_music,

];
let intervalIds = [];


/**
 * Initializes the game.
 */
function init() {
    // Initializes the level.
    initLevel();
    // Retrieves the canvas element.
    canvas = document.getElementById('canvas');
    // Creates a new World instance.
    world = new World(canvas, keyboard);
    // Plays background music.
    playBackgoundMusic();
    // Handles disappearing objects on the screen.
    handleDisappearingObjects();
    // Sets up idle functionality.
    idle();
    // Sets up events for mobile buttons.
    mobileButtonsPressEvents();
    // Handles toggling mobile buttons.
    handleMobileButtons();
}

/**
 * Handles disappearing objects on the screen.
 */
function handleDisappearingObjects() {
    // Retrieves elements for start screen and top right buttons.
    startScreen = document.getElementById('start-screen');
    topRightButtons = document.getElementById('top-right-buttons');
    // Hides the start screen and reveals top right buttons.
    startScreen.classList.add('d-none');
    topRightButtons.classList.remove('d-none');
}

/**
 * Toggles full screen mode.
 */
function fullScreen() {
    // Retrieves necessary elements.
    let container = document.getElementById('canvas-mask');
    let canvas = document.getElementById('canvas');
    let icon = document.getElementById('fullscreen-icon');
    // Enters full screen mode if not already in it.
    if (isFullscreen == false) {
        if (container.requestFullscreen) {
            container.requestFullscreen();
        } else if (container.msRequestFullscreen) {
            container.msRequestFullscreen();
        } else if (container.webkitRequestFullscreen) {
            container.webkitRequestFullscreen();
        }
        // Sets canvas dimensions and changes icon.
        canvas.style.width = '100%';
        canvas.style.height = '100%';
        icon.src = 'img/exit-fullscreen.png';
        isFullscreen = true;
    } else {
        // Exits full screen mode and changes icon.
        this.document.exitFullscreen();
        icon.src = 'img/full-screen.png';
        isFullscreen = false;
    }
}

/**
 * Toggles display of controls window.
 */
function toggleControls() {
    let controlsWindow = document.getElementById('controls-window');
    // Toggles visibility of controls window.
    if (controlsWindow.classList.contains('d-none')) {
        controlsWindow.classList.remove('d-none');
        controlsWindow.classList.add('d-flex');
    } else {
        controlsWindow.classList.remove('d-flex');
        controlsWindow.classList.add('d-none');
    }
}

/**
 * Reveals an object by its ID.
 * @param {string} id - The ID of the object to reveal.
 */
function revealObject(id) {
    let button = document.getElementById(id);
    button.classList.remove('d-none');
    button.classList.add('d-flex');
}

/**
 * Hides an object by its ID.
 * @param {string} id - The ID of the object to hide.
 */
function hideObject(id) {
    let button = document.getElementById(id);
    button.classList.remove('d-flex');
    button.classList.add('d-none');
}

/**
 * Toggles mute state of audio.
 */
function toggleMuteAudio() {
    // Toggles mute state and updates volume icon.
    if (isMuted == false) {
        soundEffects.forEach(sound => { sound.muted = true });
        isMuted = true;
        document.getElementById('volume-icon').src = "img/mute.png";
    } else {
        soundEffects.forEach(sound => { sound.muted = false });
        isMuted = false;
        document.getElementById('volume-icon').src = "img/volume.png";
    }
}

/**
 * Plays background music.
 */
function playBackgoundMusic() {
    // Plays background music with reduced volume.
    background_music.play();
    background_music.volume = 0.02;
}

/**
 * Reloads the page.
 */
function reloadPage() {
    location.reload();
}

/**
 * Sets up idle functionality.
 */
function idle() {
    // Sets up timers for short and long idle states.
    function shortIdle() {
        keyboard.idle = true;
    }

    function longIdle() {
        keyboard.idle = false;
        keyboard.long_idle = true;
    }

    var shortIdleTimer;
    var longIdleTimer;
    function resetTimer() {
        keyboard.idle = false;
        keyboard.long_idle = false;
        clearTimeout(shortIdleTimer);
        clearTimeout(longIdleTimer);
        shortIdleTimer = setTimeout(shortIdle, 3000);
        longIdleTimer = setTimeout(longIdle, 7000);
    }
    // Resets timers on user activity.
    window.addEventListener('mousemove', resetTimer, true);
    window.addEventListener('mousedown', resetTimer, true);
    window.addEventListener('click', resetTimer, true);
    window.addEventListener('keydown', resetTimer, true);
    window.addEventListener('touchstart', resetTimer, true);
}

// Event listeners for keyboard input.
window.addEventListener("keydown", (e) => {
    // Sets keyboard flags based on key presses.
    if (e.keyCode == 39) {
        keyboard.RIGHT = true;
    } if (e.keyCode == 37) {
        keyboard.LEFT = true;
    } if (e.keyCode == 40) {
        keyboard.DOWN = true;
    } if (e.keyCode == 38) {
        keyboard.UP = true;
    } if (e.keyCode == 32) {
        keyboard.SPACE = true;
    } if (e.keyCode == 68) {
        keyboard.D = true;
    }
});

window.addEventListener("keyup", (e) => {
    // Resets keyboard flags based on key releases.
    if (e.keyCode == 39) {
        keyboard.RIGHT = false;
    } if (e.keyCode == 37) {
        keyboard.LEFT = false;
    } if (e.keyCode == 40) {
        keyboard.DOWN = false;
    } if (e.keyCode == 38) {
        keyboard.UP = false;
    } if (e.keyCode == 32) {
        keyboard.SPACE = false;
    } if (e.keyCode == 68) {
        keyboard.D = false;
    }
});

/**
 * Sets up event listeners for mobile buttons.
 */
function handleMobileButtons(){
    // Reveals or hides mobile controls based on window width.
    setInterval(() => {
        if (window.innerWidth &lt; 1000) {
            revealObject("mobile-controls");
        } else {
            hideObject("mobile-controls")
        }
    }, 100);
}

/**
 * Sets up event listeners to show/hide turn device warning based on window width.
 */
function handleTurnDeviceWarning(){
    setInterval(() => {
        if (window.innerWidth &lt; 600) {
            revealObject("turn-device-warning");
        } else {
            hideObject("turn-device-warning")
        }
    }, 100);
}

/**
 * Sets up event listeners for mobile buttons press events.
 */
function mobileButtonsPressEvents() {
    // Event listeners for touch events on mobile buttons.
    document.getElementById('left').addEventListener('touchstart', (e) => {
        e.preventDefault();
        keyboard.LEFT = true;
    });

    document.getElementById('left').addEventListener('touchend', (e) => {
        e.preventDefault();
        keyboard.LEFT = false;
    });

    document.getElementById('jump').addEventListener('touchstart', (e) => {
        e.preventDefault();
        keyboard.SPACE = true;
    });

    document.getElementById('jump').addEventListener('touchend', (e) => {
        e.preventDefault();
        keyboard.SPACE = false;
    });

    document.getElementById('right').addEventListener('touchstart', (e) => {
        e.preventDefault();
        keyboard.RIGHT = true;
    });

    document.getElementById('right').addEventListener('touchend', (e) => {
        e.preventDefault();
        keyboard.RIGHT = false;
    });

    document.getElementById('throw').addEventListener('touchstart', (e) => {
        e.preventDefault();
        keyboard.D = true;
    });

    document.getElementById('throw').addEventListener('touchend', (e) => {
        e.preventDefault();
        keyboard.D = false;
    });
}</code></pre>
        </article>
    </section>




    
    
</div>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 4.0.2</a> on Mon Apr 15 2024 18:11:29 GMT+0200 (közép-európai nyári idő) using the <a href="https://github.com/clenemt/docdash">docdash</a> theme.
</footer>

<script>prettyPrint();</script>
<script src="scripts/polyfill.js"></script>
<script src="scripts/linenumber.js"></script>

<script src="scripts/search.js" defer></script>



</body>
</html>
